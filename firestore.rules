rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Función helper para verificar autenticación
    function isAuthenticated() {
      return request.auth != null;
    }

    // Reglas para Categorías
    match /categorias/{categoryId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Proveedores
    match /proveedores/{supplierId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Clientes
    match /clientes/{clientId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Repartidores
    match /repartidores/{repartidorId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Productos
    match /productos/{productId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Ventas
    match /ventas/{saleId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Apartados
    match /apartados/{apartadoId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Movimientos Financieros
    match /movimientosFinancieros/{movimientoId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Finanzas (colección alternativa)
    match /finanzas/{finanzaId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Cierres de Caja
    match /cierresCaja/{cierreId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Pedidos Web
    match /pedidosWeb/{pedidoId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Conversaciones de Chat
    match /chatConversations/{conversationId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Metas
    match /metas/{metaId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Órdenes de Recepción
    match /ordenesRecepcion/{ordenId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Liquidaciones
    match /liquidaciones/{liquidacionId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Abonos
    match /abonos/{abonoId} {
      allow read, write: if isAuthenticated();
    }

    // Reglas para Pedidos
    match /pedidos/{pedidoId} {
      allow read, write: if isAuthenticated();
    }

    // Denegar acceso a cualquier otra colección no especificada
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
